<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <!--[if IE]>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicons Icon -->
    <title>My Cart</title>
    <!-- Mobile Specific -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- CSS Style -->
    <link rel="stylesheet" type="text/css" href="~/Content/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="~/Content/font-awesome.css" media="all">
    <link rel="stylesheet" type="text/css" href="~/Content/simple-line-icons.css" media="all">
    <link rel="stylesheet" type="text/css" href="~/Content/owl.carousel.css">
    <link rel="stylesheet" type="text/css" href="~/Content/owl.theme.css">
    <link rel="stylesheet" type="text/css" href="~/Content/jquery.bxslider.css">
    <link rel="stylesheet" type="text/css" href="~/Content/jquery.mobile-menu.css">
    <link rel="stylesheet" type="text/css" href="~/Content/revslider.css">
    <link rel="stylesheet" type="text/css" href="~/Content/style_account.css">
    <link rel="stylesheet" type="text/css" href="~/Content/style.css" media="all">
    <link rel="stylesheet" type="text/css" href="~/Content/base.css" />
    <link rel="stylesheet" type="text/css" href="~/Content/cart.css">
    <script type="text/javascript" src="~/Scripts/address_all.js"></script>
    <script src=" ~/Scripts/jquery-3.3.1.js"></script>
    <link rel="stylesheet" type="text/css" href="~/Content/checkOut.css" />
    <script>
	$(document).ready(function () {
		console.log("@ViewBag.idstring");
		var j = "@ViewBag.idstring".split(" ");
		console.log(j[1]);
		console.log(j[2]);
        var js = [1, 2, 3, 4];
        $(".fixurl").attr("href", function (i, origValue){
                return origValue + "@ViewBag.customerID";
			});
		for (let i = 1; i < j.length; i++) {
			console.log("begin");
				var number = j[i].split("=");//number[0]->itemid, number[1]->count
				var id = number[0];
				js[i] = number[1];
				console.log(id);
				console.log(js[i]);
				$.get('../Shop/ItemInfo?itemid=' + id + "&itemnum" + j[i], function (data) {
					$("#img" + i).attr("src", "../Images/img/images/" + data["ItemPic"] + ".jpg");
					$("#cart" + i).text(data["ItemName"]);
					$("#price" + i).text('$'+data["ItemPrice"]+".00");
					$("#totalprice" + i).text(data["ItemPrice"] * js[i]);
					$("#quantity" + i).text(js[i]);
				});
			}

	});
    </script>
</head>
<body>
	<header>
    <div class="header-container">
      <div class="header-top">
        <div class="container">
          <div class="row"> 
           
            <div class="col-xs-7 col-sm-6">
              <div class="dropdown block-language-wrapper hidden-xs"><a data-target="#" class="block-language dropdown-toggle fixurl" href="../Homepage/Index?id="> Home Page </a>
              </div>
           
             
              <div class="dropdown block-currency-wrapper hidden-xs"> <a data-target="#" class="block-currency dropdown-toggle" href="../Login/Index"> Exit </a>
              </div>
              
              
              <div class="welcome-msg hidden-xs"> Welcome to Vibranium! </div>
            </div>
            <div class="col-xs-5 col-sm-6"> 
              <div class="top-cart-contain pull-right"> 
               
                <div class="mini-cart">
                  <div class="basket dropdown-toggle"><a class="fixurl" href="../Cart/Index?id="> My Cart </a></div>
                  </div>
                 
                  <div id="ajaxconfig_info" style="display:none"><a href="#/"></a>
                    <input value="" type="hidden">
                    <input id="enable_module" value="1" type="hidden">
                    <input class="effect_to_cart" value="1" type="hidden">
                    <input class="title_shopping_cart" value="Go to shopping cart" type="hidden">
                  </div>
                </div>
          
                <div class="top-search">
                  <div class="block-icon pull-right"> <a data-target=".bs-example-modal-lg" data-toggle="modal" class="search-focus dropdown-toggle links"> </a>
                    <div class="modal fade bs-example-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
                      <div class="modal-dialog modal-lg">
                        <div class="modal-content">
                          <div class="modal-header">
                            <button aria-label="Close" data-dismiss="modal" class="close" type="button"><img src="images/interstitial-close.png" alt="close"> </button>
                          </div>
                          <div class="modal-body">
                            <form class="navbar-form">
                              <div id="search">
                                <div class="input-group">
                                  <input name="search" placeholder="Search" class="form-control" type="text">
                                  <button type="button" class="btn-search"><i class="fa fa-search"></i></button>
                                </div>
                              </div>
                            </form>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>                 
                
                <div class="toplinks">
                  <div class="links">              
                    <div class="myaccount"><a class="fixurl" title="My Account" href="../Personalinfo/Index?id="><span class="hidden-xs">My Account</span></a></div>
                
                 

                  </div>           
                </div>
              
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>


<!-- 购物车 -->
 <div class="table_info">
     <form action="#" method="post" id="basket">
      <div class="cart-info">
        <table class="cart1">
        	<caption style="font-size: 25px;margin-top: auto;">Shopping Cart</caption>
          <thead>
            <tr>
              <td class="remove">Remove</td>
              <td class="image">Image</td>
              <td class="name">Product Name</td>
              <td class="quantity">Quantity</td>
              <td class="price">Unit Price</td>
              <td class="total">Total</td>
            </tr>
          </thead>
          <tbody>
                        <tr>
              <td class="remove"><input type="checkbox" name="remove[]" value="41" /></td>
              <td class="image"><a href="#"><img id ="img1"src="../Images/empty.jpg" alt="iMac" title="iMac" style="height: 80px;
	width: 80px;"  /></a>
                </td>
              <td class="name"><a id ="cart1" href="#">Empty</a>
              <div>
              </div>
                </td>
			  <td class="quantity" id="quantity1">0</td>
              <td class="price" id="price1">$0.00</td>
              <td class="total" id="totalprice1">$0.00</td>
            </tr>
                        <tr>
              <td class="remove"><input type="checkbox" name="remove[]" value="40" /></td>
              <td class="image"><a href="#"><img id ="img2" src="../Images/empty.jpg" alt="iPhone" title="iPhone" style="height: 80px;
	width: 80px;" /></a>
                </td>
              <td class="name"><a id ="cart2" href="#">Empty</a>
              <div>
              </div>
                </td>
              <td class="quantity" id="quantity2">0</td>
              <td class="price"id="price2">$0.00</td>
              <td class="total" id="totalprice2">$0.00</td>
            </tr>
                        <tr>
              <td class="remove"><input type="checkbox" name="remove[]" value="36" /></td>
              <td class="image"><a href="#"><img id ="img3" src="../Images/empty.jpg" alt="iPod Nano" title="iPod Nano" style="height: 80px;
	width: 80px;"  /></a>
                </td>
              <td class="name"><a id ="cart3" href="#">Empty</a>
              <div>
              </div>
                </td>
			<td class="quantity" id="quantity3">0</td>
              <td class="price" id="price3">$0.00</td>
              <td class="total" id="totalprice3">$0.00</td>
            </tr>
                                  </tbody>

        </table>
      </div>
    </form>

    <div class="buttons">
      <div class="center"><button id="pay" class="button" style="width:300px;"><span>Pay</span></button></div>
        <script>
            document.querySelector('#pay').addEventListener('click', function () {
                //console.log("@ViewBag.customerID");
                $.get('../Cart/ToOrder?user_id=' + "@ViewBag.customerID", function (data) {
                    console.log(data["Shopnumber_of_Ordernumber"]);
					console.log(data["OrderString"]);
					if (data["OrderString"] == "") alert("Your cart is empty.");
					else
                    for (let i = 1; i < data["OrderString"].split(' ').length; ++i) {
                        window.open('../Order/Index2?user_id=' + "@ViewBag.customerID" + "&shop_id=" + data["OrderString"].split(' ')[i].split('&')[0]);
                        console.log(data["OrderString"].split(' ')[i].split('&')[0]);
                    }
                })
            });
        </script>
    </div>

    </div>


    <!-- 底部导航栏 -->
    <footer style="z-index: -1">
    <div class="footer-inner">
      <div class="container">
        <div class="col-sm-12 col-xs-12 footer-logo"><img alt="Datson" src="../Images/images/logo.png"></div>
        <address>
          <i class="fa fa-map-marker"></i>Vibranium <i class="fa fa-mobile"></i><span> +(86) 123-45678910</span> <i class="fa fa-envelope"></i><span> Tongji University </span>
        </address>
      </div>
    </div>

    <div class="footer-bottom">
      <div class="container">
        <div class="row">
          <div class="col-sm-12 col-xs-12 coppyright">Copyright &copy; 2018. All rights reserved.</div>
          
        </div>
      </div>
    </div>
  </footer>

</body>